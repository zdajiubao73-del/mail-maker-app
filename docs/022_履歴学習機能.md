# 022: 履歴学習機能

## Phase
Phase 3 - 差別化強化

## 概要
ユーザーの過去のメール履歴から文体を学習し、生成メールにユーザーらしさを反映する機能。

## 学習する要素
- よく使う言い回し
- 文の長さの傾向
- 締めの挨拶パターン
- 署名のスタイル

## TODO

### 学習データ収集
- [ ] 過去に生成・編集されたメールをユーザーごとにDB保存
- [ ] 編集前後の差分を記録（ユーザーの好みを把握）
- [ ] 学習データの構造設計

### プロンプト組み込み
- [ ] メール生成時に直近N件の履歴をプロンプトに含める
- [ ] ユーザーの文体特徴をシステムプロンプトに反映
- [ ] 学習データの要約・圧縮（トークン節約）

### 学習データ管理画面
- [ ] 学習データの閲覧画面
- [ ] 個別データの削除機能
- [ ] 全学習データの一括削除機能
- [ ] 学習機能のON/OFF切り替え

### プラン制限
- [ ] 有料プランのみ利用可能にする制限

## 依存
- 003_データベース設計（learning_dataテーブル）
- 013_AIメール生成API
- 016_課金機能

## 完了条件
- 過去のメール履歴がユーザーごとに保存される
- 生成メールにユーザーの文体が反映される
- 学習データの閲覧・削除ができる
- 有料プランのみ利用可能
