# 003: データベース設計

## Phase
Phase 1 - MVP

## 概要
アプリに必要な全テーブル（コレクション）のスキーマを設計し、バックエンドに作成する。

## 背景
ユーザー情報、連絡先、メール履歴、プロンプトテンプレートなど、複数のデータモデルが必要。Phase 2以降の学習データも見据えて設計する。

## 主要テーブル

- **users** — ユーザー情報、プラン種別、生成回数カウント
- **contacts** — 連絡先（名前、メールアドレス、関係性、役職、グループ）
- **mail_accounts** — 連携メールアカウント（種別、認証状態、トークン）
- **mail_history** — 生成・送信済みメール（件名、本文、宛先、送信日時、ステータス）
- **prompt_templates** — シチュエーション別プロンプトテンプレート
- **presets** — ユーザーのプリセット設定（Phase 3用、スキーマのみ先行定義）
- **learning_data** — ユーザー学習データ（Phase 3用、スキーマのみ先行定義）

## TODO

- [ ] 各テーブルのスキーマ定義（フィールド名・型・制約）
- [ ] リレーション設計（ユーザーと連絡先、ユーザーとメール履歴等）
- [ ] Firestore / Supabase にコレクション・テーブルを作成
- [ ] セキュリティルール / RLS ポリシーの設定（ユーザーは自分のデータのみアクセス可能）
- [ ] TypeScript型定義ファイルの作成（`types/`配下）
- [ ] インデックスの設計（検索・ソート用）

## 完了条件
- 全テーブルのスキーマがドキュメント化されている
- バックエンドにテーブルが作成されている
- セキュリティルールが設定されている
- フロントエンド用の型定義が`types/`に存在する
