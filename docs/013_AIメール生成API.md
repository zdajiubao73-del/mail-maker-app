# 013: AIメール生成API

## Phase
Phase 1 - MVP

## 概要
ユーザーの入力（送信相手・目的・トーン・追加情報）とプロンプトテンプレートを組み合わせてAI APIに送信し、件名・本文を自動生成するバックエンドAPIを実装する。

## TODO

### AI API接続
- [ ] AI APIの選定（OpenAI GPT / Anthropic Claude / Google Gemini）
- [ ] APIキーの安全な管理（環境変数 / シークレットマネージャー）
- [ ] AI APIクライアントの実装（バックエンド側）
- [ ] レスポンス5秒以内の最適化（モデル選定、プロンプト最適化）
- [ ] ストリーミングレスポンスの検討

### プロンプトテンプレート
- [ ] シチュエーション別テンプレートの設計・作成
  - [ ] ビジネス系（依頼/報告/相談/調整/お詫び/お礼/案内/営業/承認/挨拶）
  - [ ] 就職・転職系（応募/面接関連/問い合わせ）
  - [ ] 学校・学術系（授業/研究/事務手続き）
  - [ ] プライベート系（お祝い/お見舞い/招待/手続き/季節の挨拶）
- [ ] テンプレートのDB登録
- [ ] テンプレート取得APIの実装

### メール生成エンドポイント
- [ ] POST /generate エンドポイントの実装
  - [ ] リクエスト: 送信相手設定 / 目的 / トーン設定 / 追加情報 / テンプレートID
  - [ ] レスポンス: 件名 / 本文
- [ ] システムプロンプトの組み立てロジック
  - [ ] テンプレート + トーン指定 + 敬語レベル + 文章長さ + 雰囲気 + 緊急度
- [ ] かんたん作成用のトーン自動推定ロジック
  - [ ] 送信相手の関係性 + 目的 → 最適なトーンを自動判定

### 制限・フィルタリング
- [ ] 無料プランの生成回数制限（1日5回）
- [ ] カウント管理（日次リセット）
- [ ] スパムフィルタリング（不適切なメール生成の防止）
- [ ] 入力バリデーション

## 依存
- 002_バックエンド環境構築
- 003_データベース設計

## 完了条件
- メール生成APIが動作し、件名・本文が返却される
- トーン設定が生成結果に反映される
- 5秒以内にレスポンスが返る
- 無料プランの回数制限が動作する
- 不適切なコンテンツがフィルタリングされる
